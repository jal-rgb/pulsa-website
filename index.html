<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pulsa - Give Your Brand a Digital Heartbeat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a;
            color: #e2e8f0;
            scroll-behavior: smooth;
        }
        .gradient-text {
            background: linear-gradient(90deg, #38bdf8, #818cf8, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .hero-bg {
            position: relative;
            background-color: #0a0a0a;
            background-image: radial-gradient(#1e293b 1px, transparent 1px);
            background-size: 24px 24px;
        }
        #mouse-trail-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }
        .card-bg {
            background-color: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(51, 65, 85, 0.5);
        }
        .cta-btn {
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        .cta-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background: radial-gradient(circle, #38bdf8, #818cf8, #c084fc);
            transition: all .6s ease;
            z-index: -1;
            transform: translate(-50%, -50%) scale(0);
            border-radius: 50%;
        }
        .cta-btn:hover::before {
            transform: translate(-50%, -50%) scale(1);
        }
        .person-container {
            transition: opacity 0.3s ease-out;
        }
        .person-dissolved {
           opacity: 0;
        }
        .digital-sphere-container {
            transition: opacity 0.5s ease-in, transform 0.5s ease-in;
            opacity: 0;
            transform: scale(0.8);
        }
        .digital-sphere-visible {
             opacity: 1;
             transform: scale(1);
        }
        .digital-sphere-pulse {
            animation: pulse 2.5s infinite ease-in-out;
        }
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 25px 7px rgba(129, 140, 248, 0.2);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 45px 20px rgba(129, 140, 248, 0.45);
            }
        }

        .digital-lines {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 0;
        }
        .spinner, .mini-spinner {
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 2px solid #38bdf8;
            animation: spin 1s linear infinite;
        }
        .spinner {
             border-width: 4px;
             width: 40px;
             height: 40px;
        }
        .mini-spinner {
            width: 20px;
            height: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-black/30 backdrop-blur-md">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="text-2xl font-bold gradient-text">Pulsa</div>
                <nav class="hidden md:flex space-x-8 items-center text-sm">
                    <a href="#services" class="hover:text-sky-400 transition-colors duration-300">Services</a>
                    <a href="#process" class="hover:text-sky-400 transition-colors duration-300">Process</a>
                    <a href="#showcase" class="hover:text-sky-400 transition-colors duration-300">Showcase</a>
                    <a href="#ai-strategy" class="hover:text-sky-400 transition-colors duration-300">AI Blueprint</a>
                    <a href="#contact" class="bg-slate-800 hover:bg-slate-700 transition-colors duration-300 text-white font-medium py-2 px-4 rounded-lg">Get Started</a>
                </nav>
                <button id="mobile-menu-button" class="md:hidden text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden">
            <a href="#services" class="block py-2 px-4 text-sm hover:bg-slate-800">Services</a>
            <a href="#process" class="block py-2 px-4 text-sm hover:bg-slate-800">Process</a>
            <a href="#showcase" class="block py-2 px-4 text-sm hover:bg-slate-800">Showcase</a>
            <a href="#ai-strategy" class="block py-2 px-4 text-sm hover:bg-slate-800">AI Blueprint</a>
            <a href="#contact" class="block py-2 px-4 text-sm hover:bg-slate-800">Get Started</a>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="hero-bg pt-32 pb-20 min-h-screen flex items-center justify-center text-center overflow-hidden">
            <canvas id="mouse-trail-canvas"></canvas>
            <div class="container mx-auto px-6 relative z-10">
                <div class="max-w-3xl mx-auto">
                    <h1 class="text-5xl md:text-7xl font-black leading-tight mb-6">
                        Give Your Brand a Digital <span class="gradient-text">Heartbeat.</span>
                    </h1>
                    <p class="text-lg md:text-xl text-slate-400 mb-10">
                        We don't just build websites. We give your vision a living pulse online, creating a dynamic presence that connects, engages, and grows.
                    </p>
                    <a href="#contact" class="cta-btn inline-block bg-sky-500 text-white font-bold text-lg px-8 py-4 rounded-lg transition-transform duration-300 hover:scale-105">
                        Start The Pulse
                    </a>
                </div>
                
                <!-- Dynamic Representation -->
                <div id="upload-animation" class="mt-20 relative h-64 flex flex-col items-center justify-end">
                    <div class="digital-lines"><canvas id="lines-canvas"></canvas></div>
                    <canvas id="particle-transform-canvas" class="absolute bottom-0 h-full w-full"></canvas>
                    <div id="digital-sphere" class="digital-sphere-container absolute bottom-1/2 translate-y-1/2 z-20">
                        <div class="w-32 h-32 rounded-full flex items-center justify-center digital-sphere-pulse" style="background: radial-gradient(circle, rgba(56,189,248,0.3) 0%, rgba(129,140,248,0.1) 50%, rgba(192,132,252,0) 70%);">
                            <svg class="w-16 h-16 gradient-text" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418" /></svg>
                        </div>
                    </div>
                    <div id="person" class="person-container relative z-10">
                        <svg class="w-20 h-20 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                        <p class="text-slate-500 mt-2 text-sm text-center">Your Vision</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="services" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-2xl mx-auto mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">How We Bring Your Brand to Life</h2>
                    <p class="text-slate-400">We build the systems that make your digital presence pulse with energy and purpose.</p>
                </div>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="card-bg rounded-xl p-8 transform hover:-translate-y-2 transition-transform duration-300 flex flex-col">
                        <div class="bg-slate-700/50 w-16 h-16 rounded-lg flex items-center justify-center mb-6"><svg class="w-8 h-8 text-sky-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg></div>
                        <h3 class="text-xl font-bold mb-3">Brand Rhythm Discovery</h3>
                        <p class="text-slate-400">We find the core heartbeat of your brand. Your values, your voice, your story—distilled into a powerful and authentic digital identity.</p>
                    </div>
                    <div class="card-bg rounded-xl p-8 transform hover:-translate-y-2 transition-transform duration-300 flex flex-col">
                        <div class="flex-grow">
                            <div class="bg-slate-700/50 w-16 h-16 rounded-lg flex items-center justify-center mb-6"><svg class="w-8 h-8 text-indigo-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75" /></svg></div>
                            <h3 class="text-xl font-bold mb-3">Content That Pulses</h3>
                            <p class="text-slate-400 mb-6">Your brand's heartbeat needs to be felt. We create a living ecosystem of content that resonates with your audience across all channels.</p>
                        </div>
                        <div class="mt-auto pt-6 border-t border-slate-700/50">
                             <input id="post-topic-input" type="text" placeholder="Enter a topic..." class="w-full text-sm bg-slate-800 border border-slate-700 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                             <button id="generate-posts-btn" class="w-full mt-2 text-sm bg-indigo-500 hover:bg-indigo-600 flex items-center justify-center text-white font-semibold py-2 px-3 rounded-md transition duration-300">✨ Generate Sample Posts</button>
                             <div id="social-posts-output" class="mt-4 text-xs text-slate-400 space-y-2"></div>
                        </div>
                    </div>
                    <div class="card-bg rounded-xl p-8 transform hover:-translate-y-2 transition-transform duration-300 flex flex-col">
                         <div class="bg-slate-700/50 w-16 h-16 rounded-lg flex items-center justify-center mb-6"><svg class="w-8 h-8 text-purple-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div>
                        <h3 class="text-xl font-bold mb-3">Audience Connection (SEO)</h3>
                        <p class="text-slate-400">A pulse is useless if no one can feel it. We make your brand discoverable, connecting its rhythm to the people searching for you.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- How it Works Section -->
        <section id="process" class="py-20 hero-bg">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-2xl mx-auto mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">The Activation Process</h2>
                    <p class="text-slate-400">Our three-step process to take your brand from concept to a living digital entity.</p>
                </div>
                <div class="relative">
                    <div class="hidden md:block absolute top-1/2 left-0 w-full h-0.5 bg-slate-700 -translate-y-1/2"></div>
                    <div class="grid md:grid-cols-3 gap-16 relative">
                        <div class="text-center"><div class="relative mb-6 inline-block"><div class="w-20 h-20 rounded-full bg-slate-800 flex items-center justify-center border-2 border-slate-700"><span class="text-3xl font-bold text-sky-400">1</span></div></div><h3 class="text-xl font-bold mb-2">Finding Your Rhythm</h3><p class="text-slate-400">We dive deep into your vision to create the strategic blueprint for your brand's unique digital pulse.</p></div>
                        <div class="text-center"><div class="relative mb-6 inline-block"><div class="w-20 h-20 rounded-full bg-slate-800 flex items-center justify-center border-2 border-slate-700"><span class="text-3xl font-bold text-indigo-400">2</span></div></div><h3 class="text-xl font-bold mb-2">Activating The Pulse</h3><p class="text-slate-400">Our team builds your digital assets. This is the moment your brand goes live and its heartbeat is first felt online.</p></div>
                        <div class="text-center"><div class="relative mb-6 inline-block"><div class="w-20 h-20 rounded-full bg-slate-800 flex items-center justify-center border-2 border-slate-700"><span class="text-3xl font-bold text-purple-400">3</span></div></div><h3 class="text-xl font-bold mb-2">Strengthening The Beat</h3><p class="text-slate-400">Your presence is alive, but it must grow stronger. We continuously amplify your reach, turning a steady pulse into a powerful rhythm.</p></div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Showcase Section -->
        <section id="showcase" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-2xl mx-auto mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">Brands We've Brought to Life</h2>
                    <p class="text-slate-400">See the vibrant digital pulses we've created for our clients.</p>
                </div>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="card-bg rounded-xl overflow-hidden group"><div class="p-8"><h3 class="text-2xl font-bold mb-2">"The Artisan Coach"</h3><p class="text-indigo-300 mb-4">From local workshops to a global online course platform.</p><p class="text-slate-400">We crafted a digital identity for a life coach that felt as authentic and handcrafted as her methods. The result was a 300% increase in client inquiries within 6 months.</p><div class="mt-6 flex items-center gap-4 flex-wrap"><span class="bg-slate-700 text-xs font-medium px-3 py-1 rounded-full">Branding</span><span class="bg-slate-700 text-xs font-medium px-3 py-1 rounded-full">Content Strategy</span><span class="bg-slate-700 text-xs font-medium px-3 py-1 rounded-full">Web Development</span></div></div></div>
                    <div class="card-bg rounded-xl overflow-hidden group"><div class="p-8"><h3 class="text-2xl font-bold mb-2">"Code & Clarity"</h3><p class="text-sky-300 mb-4">Turning a freelance developer into a sought-after tech consultant.</p><p class="text-slate-400">By building a content ecosystem of insightful tech articles and tutorials, we positioned this developer as a leading voice, attracting high-ticket consulting gigs from major tech firms.</p><div class="mt-6 flex items-center gap-4 flex-wrap"><span class="bg-slate-700 text-xs font-medium px-3 py-1 rounded-full">SEO</span><span class="bg-slate-700 text-xs font-medium px-3 py-1 rounded-full">Thought Leadership</span><span class="bg-slate-700 text-xs font-medium px-3 py-1 rounded-full">LinkedIn Growth</span></div></div></div>
                </div>
            </div>
        </section>

        <!-- AI Strategy Section -->
        <section id="ai-strategy" class="py-20 hero-bg">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">Blueprint Your Brand's Heartbeat</h2>
                    <p class="text-slate-400 mb-8">Curious about your brand's potential pulse? Describe your business, and our AI will generate a foundational blueprint for its digital life.</p>
                    <div class="card-bg p-8 rounded-2xl">
                        <textarea id="business-description" placeholder="e.g., 'A local bakery specializing in custom-designed sourdough bread' or 'A freelance graphic designer focusing on eco-friendly brands'" rows="4" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 mb-4 focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-300"></textarea>
                        <button id="generate-strategy-btn" class="cta-btn w-full bg-indigo-600 text-white font-bold text-lg px-8 py-4 rounded-lg transition-transform duration-300 hover:scale-105 flex items-center justify-center">✨ Generate Your Pulse Blueprint</button>
                    </div>
                    <div id="strategy-result-container" class="mt-8 text-left hidden">
                        <div id="strategy-loader" class="flex justify-center"><div class="spinner"></div></div>
                        <div id="strategy-output" class="card-bg p-8 rounded-2xl"></div>
                        <div id="strategy-error" class="text-red-400 mt-4 text-center"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="py-20">
            <div class="container mx-auto px-6">
                <div class="card-bg max-w-2xl mx-auto p-8 md:p-12 rounded-2xl text-center">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">Ready to Start Your Pulse?</h2>
                    <p class="text-slate-400 mb-8">Let's find your brand's rhythm. Schedule a free 15-minute call to blueprint its digital heartbeat.</p>
                    <form onsubmit="return false;">
                        <div class="flex flex-col md:flex-row gap-4 mb-4">
                            <input type="text" id="contact-name" placeholder="Your Name" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-300">
                            <input type="email" placeholder="Your Email" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-300">
                        </div>
                        <textarea id="contact-vision" placeholder="Describe your vision or key ideas..." rows="4" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 mb-2 focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-300"></textarea>
                        <button id="draft-vision-btn" class="w-full mb-4 text-sm bg-slate-700 hover:bg-slate-600 flex items-center justify-center text-white font-semibold py-2 px-3 rounded-md transition duration-300">✨ Help Me Draft My Vision</button>
                        <button type="submit" class="cta-btn w-full bg-sky-500 text-white font-bold text-lg px-8 py-4 rounded-lg transition-transform duration-300 hover:scale-105">Start the Conversation</button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="py-8 bg-slate-900/50">
        <div class="container mx-auto px-6 text-center text-slate-500">
            <p>&copy; 2024 Pulsa. All Rights Reserved. Creating Digital Vitality.</p>
        </div>
    </footer>

    <script>
        // --- API CONFIGURATION ---
        // IMPORTANT: In a real-world application, you should not expose the API key in the client-side code.
        // This should be handled by a backend server or a serverless function that makes the API call on behalf of the client.
        // For this demonstration, we are leaving it here, but it's not a secure practice for production.
        const apiKey = ""; // Leave this empty. Do not add your own key.
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        // --- GEMINI API CALLER ---
        async function callGeminiWithRetry(systemPrompt, userText, retries = 3, delay = 1000) {
            for (let i = 0; i < retries; i++) {
                try {
                    const payload = {
                        contents: [{ parts: [{ text: userText }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                    };
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        if (response.status === 429 || response.status >= 500) {
                            // Throttling or server error, so we retry
                            throw new Error(`API request failed with status ${response.status}`);
                        } else {
                            // Client-side error that shouldn't be retried
                            console.error(`Client Error: ${response.status}`);
                            throw new Error(`API request failed: ${response.status}`);
                        }
                    }

                    const result = await response.json();
                    const candidate = result.candidates?.[0];
                    if (candidate?.content?.parts?.[0]?.text) {
                        return candidate.content.parts[0].text;
                    }
                    // Handle cases where response is OK but content is missing
                    if (candidate && candidate.finishReason !== 'STOP') {
                         throw new Error(`Generation stopped for reason: ${candidate.finishReason}`);
                    }
                    throw new Error('Invalid API response format or empty content.');

                } catch (error) {
                    console.warn(`Attempt ${i + 1} failed: ${error.message}. Retrying in ${delay}ms...`);
                    if (i === retries - 1) throw error; // Re-throw the last error
                    await new Promise(res => setTimeout(res, delay));
                    delay *= 2; // Exponential backoff
                }
            }
        }
        
        // --- UI & ANIMATIONS ---
        document.getElementById('mobile-menu-button').addEventListener('click', () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });
        
        // --- HERO ANIMATION ---
        const personEl = document.getElementById('person');
        const digitalSphereEl = document.getElementById('digital-sphere');
        const transformCanvas = document.getElementById('particle-transform-canvas');
        const transformCtx = transformCanvas.getContext('2d');
        let transformParticles = [];
        
        function resizeTransformCanvas() {
            transformCanvas.width = transformCanvas.offsetWidth;
            transformCanvas.height = transformCanvas.offsetHeight;
        }
        window.addEventListener('resize', resizeTransformCanvas);
        resizeTransformCanvas();
        
        class TransformParticle {
            constructor(x, y, targetX, targetY) {
                this.x = x; this.y = y; this.targetX = targetX; this.targetY = targetY;
                this.size = Math.random() * 2.5 + 1; this.life = 1; this.decay = 0.02 + Math.random() * 0.02;
            }
            update() {
                const dx = this.targetX - this.x, dy = this.targetY - this.y;
                this.x += dx * 0.05; this.y += dy * 0.05;
                this.life -= this.decay;
                if (this.life <= 0) this.life = 0;
            }
            draw(ctx) {
                ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(129, 140, 248, ${this.life * 0.8})`; ctx.fill();
            }
        }

        function triggerUploadAnimation() {
            if (personEl.classList.contains('person-dissolved')) return;
            personEl.classList.add('person-dissolved');
            const rect = personEl.getBoundingClientRect(), canvasRect = transformCanvas.getBoundingClientRect();
            const startX = rect.left - canvasRect.left + rect.width / 2, startY = rect.top - canvasRect.top + rect.height / 2;
            const sphereRect = digitalSphereEl.getBoundingClientRect();
            const targetX = sphereRect.left - canvasRect.left + sphereRect.width / 2, targetY = sphereRect.top - canvasRect.top + sphereRect.height / 2;
            transformParticles = [];
            for (let i = 0; i < 150; i++) {
                transformParticles.push(new TransformParticle(startX + (Math.random() - 0.5) * 40, startY + (Math.random() - 0.5) * 40, targetX + (Math.random() - 0.5) * 80, targetY + (Math.random() - 0.5) * 80));
            }
            setTimeout(() => { digitalSphereEl.classList.add('digital-sphere-visible'); }, 800);
            setTimeout(() => {
                personEl.classList.remove('person-dissolved');
                digitalSphereEl.classList.remove('digital-sphere-visible');
                transformParticles = [];
            }, 4000);
        }

        function animateTransformParticles() {
            transformCtx.clearRect(0, 0, transformCanvas.width, transformCanvas.height);
            transformParticles.forEach((p, index) => {
                p.update(); p.draw(transformCtx);
                if (p.life <= 0) transformParticles.splice(index, 1);
            });
            requestAnimationFrame(animateTransformParticles);
        }
        animateTransformParticles();
        const heroObserver = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting) {
                setInterval(triggerUploadAnimation, 5000);
                heroObserver.unobserve(personEl);
            }
        }, { threshold: 0.5 });
        if(personEl) {
            heroObserver.observe(personEl);
            setTimeout(triggerUploadAnimation, 1500);
        }

        // --- MOUSE TRAIL & BG LINES ---
        const trailCanvas = document.getElementById('mouse-trail-canvas');
        const trailCtx = trailCanvas.getContext('2d');
        const linesCanvas = document.getElementById('lines-canvas');
        const linesCtx = linesCanvas.getContext('2d');
        let mouse = { x: null, y: null };
        let particles = [];
        let lines = [];
        function resizeCanvases() {
            trailCanvas.width = window.innerWidth; trailCanvas.height = window.innerHeight;
            if(linesCanvas.parentElement){
                 linesCanvas.width = linesCanvas.parentElement.offsetWidth;
                 linesCanvas.height = linesCanvas.parentElement.offsetHeight;
                 initLines();
            }
        }
        window.addEventListener('resize', resizeCanvases); resizeCanvases();
        window.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; });
        class Particle { constructor() { this.x = mouse.x; this.y = mouse.y; this.size = Math.random() * 2 + 1; this.speedX = Math.random() * 2 - 1; this.speedY = Math.random() * 2 - 1; this.color = `hsl(${Math.random() * 60 + 200}, 100%, 70%)`; } update() { this.x += this.speedX; this.y += this.speedY; if (this.size > 0.1) this.size -= 0.03; } draw() { trailCtx.fillStyle = this.color; trailCtx.beginPath(); trailCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2); trailCtx.fill(); } }
        function handleParticles() { if (mouse.x !== null) { for (let i = 0; i < 2; i++) { particles.push(new Particle()); } } for (let i = 0; i < particles.length; i++) { particles[i].update(); particles[i].draw(); if (particles[i].size <= 0.3) { particles.splice(i, 1); i--; } } }
        class Line { constructor(x) { this.x = x; this.y = 0; this.speed = Math.random() * 0.5 + 0.1; this.height = linesCanvas.height; this.opacity = Math.random() * 0.3 + 0.1; } update() { this.y += this.speed; if (this.y > this.height) { this.y = 0; } } draw() { linesCtx.strokeStyle = `rgba(51, 65, 85, ${this.opacity})`; linesCtx.beginPath(); linesCtx.moveTo(this.x, this.y); linesCtx.lineTo(this.x, this.y - 20); linesCtx.stroke(); } }
        function initLines() { lines = []; for (let i = 0; i < linesCanvas.width / 30; i++) { lines.push(new Line(Math.random() * linesCanvas.width)); } }
        function handleLines() { linesCtx.clearRect(0, 0, linesCanvas.width, linesCanvas.height); lines.forEach(line => { line.update(); line.draw(); }); }
        function animateAll() { trailCtx.clearRect(0, 0, trailCanvas.width, trailCanvas.height); handleParticles(); handleLines(); requestAnimationFrame(animateAll); }
        initLines(); animateAll();

        // --- GEMINI FEATURES ---
        document.getElementById('generate-strategy-btn').addEventListener('click', async () => {
            const businessDesc = document.getElementById('business-description').value;
            const container = document.getElementById('strategy-result-container');
            const loader = document.getElementById('strategy-loader');
            const outputDiv = document.getElementById('strategy-output');
            const errorDiv = document.getElementById('strategy-error');
            
            if (!businessDesc.trim()) {
                errorDiv.textContent = 'Please describe your business first.';
                container.classList.remove('hidden');
                outputDiv.parentElement.classList.add('hidden');
                loader.classList.add('hidden');
                return;
            }

            container.classList.remove('hidden');
            loader.classList.remove('hidden');
            outputDiv.parentElement.classList.add('hidden');
            errorDiv.textContent = '';
            
            const systemPrompt = `You are an expert digital marketing strategist for a brand called "Pulsa". A user will provide a business description. Your task is to generate a concise, actionable digital marketing blueprint. The tone should be inspiring and use "pulse" and "heartbeat" metaphors. Format using markdown with ### for headings and lists. Start every point in a list with a bolded keyword followed by a colon.`;
            
            try {
                const generatedText = await callGeminiWithRetry(systemPrompt, `Create a pulse blueprint for: ${businessDesc}`);
                let htmlOutput = generatedText.replace(/### (.*)/g, '<h3 class="text-xl font-bold mb-4 gradient-text">$1</h3>');
                htmlOutput = htmlOutput.replace(/\n\n/g, '<br><br>');
                htmlOutput = htmlOutput.replace(/\n- \*\*(.*?):\*\* (.*)/g, '<li class="mb-2"><strong class="text-sky-300">$1:</strong> $2</li>');
                htmlOutput = htmlOutput.replace(/<\/ul>\s*<ul>/g, ''); // Fix for multiple lists
                if(!htmlOutput.startsWith('<ul>')) htmlOutput = '<ul>' + htmlOutput;
                if(!htmlOutput.endsWith('</ul>')) htmlOutput = htmlOutput + '</ul>';
                outputDiv.innerHTML = htmlOutput;
                outputDiv.parentElement.classList.remove('hidden');
            } catch (error) {
                console.error('Error fetching strategy:', error);
                errorDiv.textContent = 'Sorry, we couldn\'t generate a blueprint right now. Please try again later.';
            } finally {
                loader.classList.add('hidden');
            }
        });
        
        document.getElementById('generate-posts-btn').addEventListener('click', async () => {
            const topic = document.getElementById('post-topic-input').value;
            const outputDiv = document.getElementById('social-posts-output');
            if (!topic.trim()) {
                outputDiv.innerHTML = `<p class="text-red-400">Please enter a topic.</p>`;
                return;
            }
            outputDiv.innerHTML = `<div class="flex justify-center"><div class="mini-spinner"></div></div>`;
            const systemPrompt = `You are a creative social media manager. Given a topic, generate two short, engaging social media posts: one for LinkedIn (professional, insightful), and one for Instagram (punchy, visual, with relevant hashtags). Format with **LinkedIn:** and **Instagram:** labels.`;
            try {
                const generatedText = await callGeminiWithRetry(systemPrompt, topic);
                outputDiv.innerHTML = generatedText.replace(/\*\*LinkedIn:\*\*/g, '<strong class="text-indigo-300">LinkedIn:</strong>').replace(/\*\*Instagram:\*\*/g, '<strong class="text-indigo-300">Instagram:</strong>').replace(/\n/g, '<br>');
            } catch(error) {
                console.error("Error generating posts:", error);
                outputDiv.innerHTML = `<p class="text-red-400">Failed to generate posts. Please try again.</p>`;
            }
        });

        document.getElementById('draft-vision-btn').addEventListener('click', async () => {
            const visionTextarea = document.getElementById('contact-vision');
            const initialText = visionTextarea.value;
            const btn = document.getElementById('draft-vision-btn');
            const originalButtonText = btn.innerHTML;
            if(!initialText.trim()){
                visionTextarea.placeholder = "Please enter some ideas first!";
                return;
            }

            btn.innerHTML = `<div class="mini-spinner"></div>`;
            btn.disabled = true;
            const systemPrompt = `You are a helpful assistant for a digital marketing agency called "Pulsa". A user wants to contact them. Their rough idea is provided. Expand this into a polite, professional, and clear message of 3-4 sentences that effectively communicates their core idea and goal.`;
            try {
                visionTextarea.value = await callGeminiWithRetry(systemPrompt, initialText);
            } catch(error) {
                console.error("Error drafting vision:", error);
                visionTextarea.placeholder = "Sorry, couldn't draft the message. Please try again.";
            } finally {
                btn.innerHTML = originalButtonText;
                btn.disabled = false;
            }
        });
    </script>
</body>
</html>
